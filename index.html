<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI Career Coach</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap"
    rel="stylesheet"
  />
  <style>
    :root {
      --bg: #050510;
      --bg-alt: #0b0b1a;
      --card: #111122;
      --accent: #ff3ea5;
      --accent-soft: rgba(255, 62, 165, 0.25);
      --accent-strong: rgba(255, 62, 165, 0.9);
      --text: #f5f5ff;
      --muted: #a0a0c0;
      --border: #26263a;
      --danger: #ff4b81;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: radial-gradient(circle at top, #1a1028 0, #050510 45%, #020208 100%);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      align-items: stretch;
      justify-content: center;
      padding: 16px;
    }

    .app-shell {
      width: 100%;
      max-width: 1100px;
      border-radius: 24px;
      background: linear-gradient(135deg, rgba(255, 62, 165, 0.08), rgba(0, 0, 0, 0.9));
      border: 1px solid rgba(255, 62, 165, 0.35);
      box-shadow:
        0 0 40px rgba(255, 62, 165, 0.35),
        0 0 120px rgba(255, 62, 165, 0.15);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      backdrop-filter: blur(18px);
    }

    .app-header {
      padding: 18px 22px;
      border-bottom: 1px solid rgba(255, 62, 165, 0.35);
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: radial-gradient(circle at top left, rgba(255, 62, 165, 0.25), transparent 55%);
      position: relative;
    }

    .app-header::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top right, rgba(255, 255, 255, 0.06), transparent 60%);
      opacity: 0.7;
      pointer-events: none;
    }

    .header-left {
      position: relative;
      z-index: 1;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-orb {
      width: 34px;
      height: 34px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 20%, #ffe6f7, #ff3ea5 40%, #7b1fa2 80%);
      box-shadow:
        0 0 18px rgba(255, 62, 165, 0.9),
        0 0 40px rgba(255, 62, 165, 0.5);
      position: relative;
      overflow: hidden;
    }

    .logo-orb::after {
      content: "";
      position: absolute;
      inset: 4px;
      border-radius: inherit;
      border: 1px solid rgba(255, 255, 255, 0.4);
      opacity: 0.7;
    }

    .header-title {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .header-title h1 {
      font-size: 1.1rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .header-title h1 span {
      font-size: 0.7rem;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255, 62, 165, 0.6);
      background: rgba(5, 5, 16, 0.8);
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--accent);
    }

    .header-title p {
      font-size: 0.8rem;
      color: var(--muted);
    }

    .header-right {
      position: relative;
      z-index: 1;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .status-pill {
      font-size: 0.75rem;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(0, 255, 170, 0.5);
      color: #8fffd0;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: rgba(0, 0, 0, 0.6);
    }

    .status-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #00ff99;
      box-shadow: 0 0 10px rgba(0, 255, 153, 0.9);
    }

    .tag-pill {
      font-size: 0.75rem;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.18);
      color: var(--muted);
      background: rgba(5, 5, 16, 0.8);
    }

    .app-body {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 0.9fr);
      gap: 0;
      min-height: 520px;
    }

    @media (max-width: 900px) {
      .app-body {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .panel {
      padding: 18px 20px 20px;
    }

    .panel + .panel {
      border-left: 1px solid rgba(255, 62, 165, 0.25);
    }

    @media (max-width: 900px) {
      .panel + .panel {
        border-left: none;
        border-top: 1px solid rgba(255, 62, 165, 0.25);
      }
    }

    .panel-title {
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--muted);
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }

    .panel-title span {
      font-size: 0.7rem;
      color: var(--accent);
    }

    .input-card {
      background: radial-gradient(circle at top left, rgba(255, 62, 165, 0.18), rgba(5, 5, 16, 0.96));
      border-radius: 18px;
      border: 1px solid rgba(255, 62, 165, 0.4);
      padding: 14px;
      box-shadow: 0 0 24px rgba(255, 62, 165, 0.25);
      margin-bottom: 12px;
    }

    .input-label {
      font-size: 0.8rem;
      color: var(--muted);
      margin-bottom: 6px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }

    .input-label span {
      font-size: 0.7rem;
      color: var(--accent);
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }

    textarea {
      width: 100%;
      min-height: 90px;
      max-height: 200px;
      resize: vertical;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      background: rgba(3, 3, 12, 0.9);
      color: var(--text);
      padding: 10px 11px;
      font-size: 0.85rem;
      outline: none;
      transition: border 0.18s ease, box-shadow 0.18s ease, background 0.18s ease;
    }

    textarea::placeholder {
      color: rgba(160, 160, 192, 0.7);
    }

    textarea:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(255, 62, 165, 0.5);
      background: rgba(5, 5, 18, 0.98);
    }

    .quick-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 6px;
    }

    .chip {
      font-size: 0.75rem;
      padding: 5px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255, 62, 165, 0.5);
      color: var(--accent);
      background: rgba(5, 5, 16, 0.9);
      cursor: pointer;
      transition: background 0.18s ease, transform 0.12s ease, box-shadow 0.18s ease;
    }

    .chip:hover {
      background: rgba(255, 62, 165, 0.12);
      transform: translateY(-1px);
      box-shadow: 0 0 12px rgba(255, 62, 165, 0.4);
    }

    .primary-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
      align-items: center;
      justify-content: space-between;
    }

    .btn-main {
      flex: 1 1 180px;
      border-radius: 999px;
      border: 1px solid rgba(255, 62, 165, 0.9);
      background: radial-gradient(circle at 20% 0, #ff9ed6, #ff3ea5 40%, #7b1fa2 90%);
      color: #050510;
      font-weight: 700;
      font-size: 0.9rem;
      padding: 10px 16px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow:
        0 0 18px rgba(255, 62, 165, 0.9),
        0 0 40px rgba(255, 62, 165, 0.4);
      transition: transform 0.12s ease, box-shadow 0.18s ease, filter 0.18s ease, opacity 0.18s ease;
    }

    .btn-main span {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
    }

    .btn-main:hover {
      transform: translateY(-1px);
      filter: brightness(1.05);
      box-shadow:
        0 0 26px rgba(255, 62, 165, 1),
        0 0 60px rgba(255, 62, 165, 0.6);
    }

    .btn-main:disabled {
      opacity: 0.6;
      cursor: default;
      transform: none;
      box-shadow: none;
    }

    .btn-secondary {
      flex: 0 0 auto;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.18);
      background: rgba(5, 5, 16, 0.9);
      color: var(--muted);
      font-size: 0.8rem;
      padding: 8px 12px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: background 0.18s ease, border 0.18s ease, color 0.18s ease, transform 0.12s ease;
    }

    .btn-secondary:hover {
      background: rgba(255, 62, 165, 0.08);
      border-color: rgba(255, 62, 165, 0.6);
      color: var(--accent);
      transform: translateY(-1px);
    }

    .hint-text {
      font-size: 0.75rem;
      color: var(--muted);
      margin-top: 6px;
    }

    .hint-text strong {
      color: var(--accent);
      font-weight: 600;
    }

    .chat-shell {
      height: 100%;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .chat-window {
      flex: 1;
      min-height: 260px;
      max-height: 420px;
      border-radius: 18px;
      border: 1px solid rgba(255, 62, 165, 0.4);
      background:
        radial-gradient(circle at top left, rgba(255, 62, 165, 0.18), transparent 55%),
        radial-gradient(circle at bottom right, rgba(255, 62, 165, 0.12), #050510);
      padding: 12px;
      overflow-y: auto;
      position: relative;
      box-shadow: 0 0 24px rgba(255, 62, 165, 0.25);
    }

    .chat-window::-webkit-scrollbar {
      width: 6px;
    }

    .chat-window::-webkit-scrollbar-thumb {
      background: rgba(255, 62, 165, 0.5);
      border-radius: 999px;
    }

    .chat-message {
      max-width: 92%;
      margin-bottom: 10px;
      padding: 9px 11px;
      border-radius: 14px;
      font-size: 0.85rem;
      line-height: 1.4;
      position: relative;
      animation: fadeInUp 0.18s ease-out;
      white-space: pre-wrap;
    }

    .chat-message.user {
      margin-left: auto;
      background: rgba(5, 5, 16, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.16);
      color: var(--text);
    }

    .chat-message.assistant {
      margin-right: auto;
      background: rgba(255, 62, 165, 0.12);
      border: 1px solid rgba(255, 62, 165, 0.7);
      color: #ffe6f7;
      box-shadow: 0 0 18px rgba(255, 62, 165, 0.5);
    }

    .chat-meta {
      font-size: 0.7rem;
      color: var(--muted);
      margin-bottom: 4px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .chat-meta span {
      font-size: 0.65rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: rgba(255, 62, 165, 0.8);
    }

    .typing-indicator {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255, 62, 165, 0.6);
      background: rgba(5, 5, 16, 0.9);
      font-size: 0.75rem;
      color: var(--accent);
      position: absolute;
      bottom: 10px;
      left: 12px;
    }

    .typing-dot {
      width: 5px;
      height: 5px;
      border-radius: 999px;
      background: rgba(255, 62, 165, 0.9);
      animation: pulse 1s infinite ease-in-out;
    }

    .typing-dot:nth-child(2) {
      animation-delay: 0.15s;
    }

    .typing-dot:nth-child(3) {
      animation-delay: 0.3s;
    }

    .chat-input-row {
      margin-top: 6px;
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .chat-input {
      flex: 1;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.16);
      background: rgba(5, 5, 16, 0.9);
      color: var(--text);
      padding: 8px 12px;
      font-size: 0.8rem;
      outline: none;
      transition: border 0.18s ease, box-shadow 0.18s ease, background 0.18s ease;
    }

    .chat-input::placeholder {
      color: rgba(160, 160, 192, 0.7);
    }

    .chat-input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(255, 62, 165, 0.5);
      background: rgba(5, 5, 18, 0.98);
    }

    .btn-send {
      border-radius: 999px;
      border: 1px solid rgba(255, 62, 165, 0.9);
      background: radial-gradient(circle at 20% 0, #ff9ed6, #ff3ea5 40%, #7b1fa2 90%);
      color: #050510;
      font-weight: 700;
      font-size: 0.8rem;
      padding: 8px 12px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow:
        0 0 14px rgba(255, 62, 165, 0.9),
        0 0 30px rgba(255, 62, 165, 0.4);
      transition: transform 0.12s ease, box-shadow 0.18s ease, filter 0.18s ease, opacity 0.18s ease;
    }

    .btn-send:hover {
      transform: translateY(-1px);
      filter: brightness(1.05);
      box-shadow:
        0 0 20px rgba(255, 62, 165, 1),
        0 0 40px rgba(255, 62, 165, 0.6);
    }

    .btn-send:disabled {
      opacity: 0.6;
      cursor: default;
      transform: none;
      box-shadow: none;
    }

    .badge-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 4px;
    }

    .badge {
      font-size: 0.7rem;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.16);
      color: var(--muted);
      background: rgba(5, 5, 16, 0.9);
    }

    .badge strong {
      color: var(--accent);
      font-weight: 600;
    }

    .error-banner {
      margin-top: 8px;
      font-size: 0.78rem;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid rgba(255, 75, 129, 0.8);
      background: rgba(80, 0, 40, 0.7);
      color: #ffe6f0;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(4px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes pulse {
      0%, 100% {
        transform: scale(1);
        opacity: 0.6;
      }
      50% {
        transform: scale(1.4);
        opacity: 1;
      }
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <header class="app-header">
      <div class="header-left">
        <div class="logo-orb"></div>
        <div class="header-title">
          <h1>AI Career Coach <span>Agent</span></h1>
          <p>Your neon‑pink mentor for CVs, LinkedIn, and interviews.</p>
        </div>
      </div>
      <div class="header-right">
        <div class="status-pill">
          <div class="status-dot"></div>
          Live Agent
        </div>
        <div class="tag-pill">LLM‑powered • Vercel • Serverless</div>
      </div>
    </header>

    <div class="app-body">
      <!-- LEFT PANEL: INPUTS -->
      <section class="panel">
        <div class="panel-title">
          INPUTS
          <span>CV • Job Description • Focus</span>
        </div>

        <div class="input-card">
          <div class="input-label">
            Your CV / Resume
            <span>Paste text</span>
          </div>
          <textarea id="cvInput" placeholder="Paste your CV or resume here. You can include bullet points, roles, achievements, and skills."></textarea>
          <div class="quick-actions">
            <button class="chip" data-prompt="Rewrite my CV to be more concise and impact‑driven.">Make concise</button>
            <button class="chip" data-prompt="Rewrite my CV to match the job description.">Match job</button>
          </div>
        </div>

        <div class="input-card">
          <div class="input-label">
            Job Description (Optional)
            <span>Target role</span>
          </div>
          <textarea id="jdInput" placeholder="Paste the job description here if you want the AI to tailor your CV, cover letter, or answers to a specific role."></textarea>
          <div class="quick-actions">
            <button class="chip" data-prompt="Highlight the top 5 skills this job is really asking for.">Extract skills</button>
            <button class="chip" data-prompt="Explain how my experience maps to this job.">Map my experience</button>
          </div>
        </div>

        <div class="input-card">
          <div class="input-label">
            What do you want help with?
            <span>Focus</span>
          </div>
          <div class="quick-actions">
            <button class="chip" data-prompt="Rewrite my CV to be tailored to this job and optimized for clarity and impact.">Rewrite my CV</button>
            <button class="chip" data-prompt="Write a compelling cover letter for this job based on my CV.">Cover letter</button>
            <button class="chip" data-prompt="Rewrite my LinkedIn About section to sound confident, clear, and authentic.">LinkedIn About</button>
            <button class="chip" data-prompt="Give me 10 targeted interview questions and strong sample answers for this role.">Interview prep</button>
          </div>
          <div class="primary-actions">
            <button id="analyzeBtn" class="btn-main">
              <span>Run Career Agent</span>
            </button>
            <button id="clearBtn" class="btn-secondary">
              Clear inputs
            </button>
          </div>
          <p class="hint-text">
            The agent will combine your <strong>CV</strong>, the <strong>job description</strong> (if provided), and your <strong>focus</strong> to respond like a professional career coach.
          </p>
        </div>

        <div class="badge-row">
          <div class="badge"><strong>Safe:</strong> No medical, legal, or financial advice.</div>
          <div class="badge"><strong>Use case:</strong> CVs, LinkedIn, interviews, career clarity.</div>
        </div>

        <div id="errorBox" class="error-banner" style="display:none;"></div>
      </section>

      <!-- RIGHT PANEL: CHAT -->
      <section class="panel">
        <div class="panel-title">
          COACH CONSOLE
          <span>Chat • Feedback • Strategy</span>
        </div>

        <div class="chat-shell">
          <div id="chatWindow" class="chat-window">
            <div class="chat-message assistant">
              <div class="chat-meta">
                <span>AI CAREER COACH</span> • Welcome
              </div>
              Hey, I’m your AI Career Coach. Paste your CV, optionally add a job description, then tell me what you want:
              rewrite your CV, craft a cover letter, sharpen your LinkedIn, or prep for interviews. I’ll respond with
              clear, structured, practical guidance you can actually use.
            </div>
          </div>

          <div class="chat-input-row">
            <input
              id="chatInput"
              class="chat-input"
              placeholder="Ask something like: “Rewrite my CV for a senior product role” or “What skills am I missing?”"
            />
            <button id="sendBtn" class="btn-send">
              Send
            </button>
          </div>
          <p class="hint-text">
            Your messages are combined with your CV and job description so the agent can respond with context‑aware advice.
          </p>
        </div>
      </section>
    </div>
  </div>

  <script>
    const cvInput = document.getElementById("cvInput");
    const jdInput = document.getElementById("jdInput");
    const analyzeBtn = document.getElementById("analyzeBtn");
    const clearBtn = document.getElementById("clearBtn");
    const chatWindow = document.getElementById("chatWindow");
    const chatInput = document.getElementById("chatInput");
    const sendBtn = document.getElementById("sendBtn");
    const errorBox = document.getElementById("errorBox");

    let isLoading = false;
    let typingEl = null;

    function appendMessage(role, text, metaLabel) {
      const wrapper = document.createElement("div");
      wrapper.className = "chat-message " + (role === "user" ? "user" : "assistant");

      if (metaLabel) {
        const meta = document.createElement("div");
        meta.className = "chat-meta";
        const span = document.createElement("span");
        span.textContent = metaLabel;
        meta.appendChild(span);
        wrapper.appendChild(meta);
      }

      const body = document.createElement("div");
      body.textContent = text;
      wrapper.appendChild(body);

      chatWindow.appendChild(wrapper);
      chatWindow.scrollTop = chatWindow.scrollHeight;
    }

    function showTyping() {
      if (typingEl) return;
      typingEl = document.createElement("div");
      typingEl.className = "typing-indicator";
      typingEl.innerHTML = `
        <span>Thinking</span>
        <div class="typing-dot"></div>
        <div class="typing-dot"></div>
        <div class="typing-dot"></div>
      `;
      chatWindow.appendChild(typingEl);
      chatWindow.scrollTop = chatWindow.scrollHeight;
    }

    function hideTyping() {
      if (typingEl && typingEl.parentNode) {
        typingEl.parentNode.removeChild(typingEl);
      }
      typingEl = null;
    }

    function setLoading(state) {
      isLoading = state;
      analyzeBtn.disabled = state;
      sendBtn.disabled = state;
      if (state) {
        analyzeBtn.innerHTML = "<span>Running...</span>";
      } else {
        analyzeBtn.innerHTML = "<span>Run Career Agent</span>";
      }
    }

    function setError(msg) {
      if (!msg) {
        errorBox.style.display = "none";
        errorBox.textContent = "";
        return;
      }
      errorBox.style.display = "block";
      errorBox.textContent = msg;
    }

    async function callCareerCoach(userMessage) {
      const cv = cvInput.value.trim();
      const jd = jdInput.value.trim();

      if (!cv && !jd && !userMessage) {
        setError("Add at least your CV, a job description, or a question so the agent has something to work with.");
        return;
      }

      setError("");
      setLoading(true);
      showTyping();

      try {
        const res = await fetch("/api/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            cv,
            jobDescription: jd,
            message: userMessage || "",
          }),
        });

        if (!res.ok) {
          const text = await res.text();
          throw new Error(text || "Request failed");
        }

        const data = await res.json();
        const reply = data.reply || "I couldn’t generate a response. Please try again with a bit more detail.";

        appendMessage("assistant", reply, "AI CAREER COACH");
      } catch (err) {
        console.error(err);
        setError("Something went wrong talking to the AI. Check your API key on Vercel and try again.");
      } finally {
        hideTyping();
        setLoading(false);
      }
    }

    analyzeBtn.addEventListener("click", () => {
      const defaultPrompt =
        "Act as a senior career coach. Analyze my CV and the job description (if provided). " +
        "Give me a clear, structured response with: 1) a short summary of my profile, " +
        "2) how well I match the role, 3) concrete improvements to my CV, and 4) next steps.";
      appendMessage("user", defaultPrompt, "FOCUS");
      callCareerCoach(defaultPrompt);
    });

    clearBtn.addEventListener("click", () => {
      cvInput.value = "";
      jdInput.value = "";
      setError("");
    });

    document.querySelectorAll(".chip").forEach((chip) => {
      chip.addEventListener("click", () => {
        const prompt = chip.getAttribute("data-prompt");
        if (!prompt) return;
        appendMessage("user", prompt, "FOCUS");
        callCareerCoach(prompt);
      });
    });

    sendBtn.addEventListener("click", () => {
      const msg = chatInput.value.trim();
      if (!msg || isLoading) return;
      chatInput.value = "";
      appendMessage("user", msg, "YOU");
      callCareerCoach(msg);
    });

    chatInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter" && !e.shiftKey) {
        e.preventDefault();
        sendBtn.click();
      }
    });
  </script>
</body>
</html>
